<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src *;">
  <title>OtherThing Node</title>
  <style>
    :root {
      --bg-dark: #050508;
      --bg-surface: #0a0a0f;
      --bg-elevated: #12121a;
      --bg-card: #16161f;
      --border-subtle: rgba(255,255,255,0.08);
      --border-accent: rgba(0,212,255,0.3);
      --primary: #00d4ff;
      --primary-light: #ff00ff;
      --success: #00ff41;
      --warning: #ffaa00;
      --error: #ff3366;
      --text-primary: #ffffff;
      --text-secondary: #a0a0b0;
      --text-muted: #606070;
      --glow-primary: 0 0 20px rgba(0,212,255,0.3);
      --glow-success: 0 0 20px rgba(0,255,65,0.3);
      --font-mono: 'Consolas', 'Monaco', monospace;
      --font-display: 'Segoe UI', system-ui, sans-serif;
      --radius: 12px;
      --radius-sm: 8px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: var(--font-display);
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-y: auto;
    }

    /* Title Bar */
    .title-bar {
      -webkit-app-region: drag;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 16px;
      background: linear-gradient(180deg, #0c0c12 0%, #08080c 100%);
      border-bottom: 1px solid var(--border-subtle);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .title-bar-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .title-bar-logo {
      width: 24px;
      height: 24px;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 12px;
      color: #000;
    }
    .title-bar-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-secondary);
    }
    .window-controls {
      display: flex;
      gap: 6px;
      -webkit-app-region: no-drag;
    }
    .window-btn {
      width: 36px;
      height: 28px;
      border: none;
      border-radius: 6px;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
    }
    .window-btn:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text-primary);
    }
    .window-btn.close:hover {
      background: var(--error);
      color: #fff;
    }

    /* Main Content */
    .main-content {
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    /* Status Banner */
    .status-banner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface));
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius);
      margin-bottom: 20px;
    }
    .status-banner.connected {
      background: linear-gradient(135deg, rgba(0,255,65,0.1), rgba(0,212,255,0.05));
      border-color: rgba(0,255,65,0.3);
    }
    .status-info {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .status-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    .status-icon.online {
      border-color: var(--success);
      box-shadow: var(--glow-success);
      animation: pulse-glow 2s infinite;
    }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 10px rgba(0,255,65,0.3); }
      50% { box-shadow: 0 0 25px rgba(0,255,65,0.5); }
    }
    .status-icon svg {
      width: 24px;
      height: 24px;
    }
    .status-text h2 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .status-text p {
      font-size: 0.8rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }
    .status-indicators {
      display: flex;
      gap: 20px;
    }
    .indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      color: var(--text-secondary);
    }
    .indicator-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-muted);
    }
    .indicator-dot.online { background: var(--success); box-shadow: 0 0 8px var(--success); }
    .indicator-dot.connecting { background: var(--warning); animation: blink 1s infinite; }
    @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }

    /* Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius);
      margin-bottom: 16px;
      overflow: hidden;
    }
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      background: var(--bg-elevated);
      border-bottom: 1px solid var(--border-subtle);
    }
    .card-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-secondary);
    }
    .card-title svg {
      width: 14px;
      height: 14px;
      color: var(--primary);
    }
    .card-body {
      padding: 18px;
    }

    /* Share Key */
    .share-key-card {
      background: linear-gradient(135deg, rgba(0,212,255,0.08), rgba(255,0,255,0.05));
      border-color: var(--border-accent);
      text-align: center;
      display: none;
    }
    .share-key-card.visible { display: block; }
    .share-key-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    .share-key-value {
      font-family: var(--font-mono);
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary);
      letter-spacing: 6px;
      text-shadow: var(--glow-primary);
      margin-bottom: 12px;
    }
    .share-key-hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 16px;
    }
    .btn-copy {
      padding: 10px 24px;
      background: rgba(0,212,255,0.15);
      border: 1px solid var(--primary);
      border-radius: var(--radius-sm);
      color: var(--primary);
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-copy:hover {
      background: rgba(0,212,255,0.25);
      box-shadow: var(--glow-primary);
    }
    .btn-copy.copied {
      background: rgba(0,255,65,0.2);
      border-color: var(--success);
      color: var(--success);
    }

    /* Hardware Grid */
    .hw-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    .hw-item {
      padding: 14px;
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
    }
    .hw-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 6px;
    }
    .hw-value {
      font-family: var(--font-mono);
      font-size: 1rem;
      color: var(--primary);
    }
    .hw-value.secondary { color: var(--text-primary); font-size: 0.9rem; }

    /* GPU List */
    .gpu-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 16px;
    }
    .gpu-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      background: linear-gradient(135deg, rgba(255,0,255,0.05), rgba(0,212,255,0.02));
      border: 1px solid rgba(255,0,255,0.2);
      border-radius: var(--radius-sm);
    }
    .gpu-badge {
      padding: 4px 10px;
      background: rgba(118,185,0,0.15);
      border: 1px solid rgba(118,185,0,0.4);
      border-radius: 4px;
      font-size: 0.65rem;
      font-family: var(--font-mono);
      color: #76b900;
      text-transform: uppercase;
    }
    .gpu-badge.amd {
      background: rgba(237,28,36,0.15);
      border-color: rgba(237,28,36,0.4);
      color: #ed1c24;
    }
    .gpu-name {
      flex: 1;
      font-size: 0.9rem;
      color: var(--primary-light);
    }
    .gpu-vram {
      font-family: var(--font-mono);
      font-size: 0.85rem;
      color: var(--primary);
    }

    /* Resource Sliders */
    .limit-row {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 12px 0;
      border-bottom: 1px solid var(--border-subtle);
    }
    .limit-row:last-of-type { border-bottom: none; }
    .limit-label {
      min-width: 90px;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }
    .limit-slider {
      flex: 1;
      -webkit-appearance: none;
      height: 6px;
      border-radius: 3px;
      background: var(--bg-dark);
      outline: none;
    }
    .limit-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), #0099bb);
      cursor: pointer;
      box-shadow: 0 0 10px rgba(0,212,255,0.4);
      transition: box-shadow 0.2s;
    }
    .limit-slider::-webkit-slider-thumb:hover {
      box-shadow: 0 0 15px rgba(0,212,255,0.6);
    }
    .limit-value {
      min-width: 80px;
      text-align: right;
      font-family: var(--font-mono);
      font-size: 0.85rem;
      color: var(--primary);
    }

    /* Workspaces */
    .workspace-list {
      max-height: 180px;
      overflow-y: auto;
    }
    .workspace-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      margin-bottom: 8px;
    }
    .workspace-item.assigned {
      background: rgba(0,212,255,0.08);
      border-color: rgba(0,212,255,0.3);
    }
    .workspace-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--text-muted);
    }
    .workspace-item.assigned .workspace-dot {
      background: var(--success);
      box-shadow: 0 0 8px var(--success);
    }
    .workspace-name {
      flex: 1;
      font-size: 0.9rem;
    }
    .workspace-empty {
      text-align: center;
      padding: 24px;
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    /* Settings Toggle */
    .setting-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 0;
      border-bottom: 1px solid var(--border-subtle);
    }
    .setting-row:last-child { border-bottom: none; }
    .setting-info h4 {
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 4px;
    }
    .setting-info p {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .toggle {
      width: 48px;
      height: 26px;
      background: var(--bg-dark);
      border-radius: 13px;
      cursor: pointer;
      position: relative;
      transition: background 0.2s;
    }
    .toggle.active {
      background: linear-gradient(135deg, var(--primary), #0099bb);
    }
    .toggle::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      background: #fff;
      border-radius: 50%;
      transition: transform 0.2s;
    }
    .toggle.active::after {
      transform: translateX(22px);
    }

    /* IPFS Status */
    .ipfs-status {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      margin-bottom: 12px;
    }
    .ipfs-status.running {
      background: linear-gradient(135deg, rgba(0,255,65,0.08), rgba(0,212,255,0.05));
      border-color: rgba(0,255,65,0.3);
    }
    .ipfs-status-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .ipfs-status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--text-muted);
    }
    .ipfs-status-dot.online {
      background: var(--success);
      box-shadow: 0 0 8px var(--success);
    }
    .ipfs-status-text h4 {
      font-size: 0.85rem;
      margin-bottom: 2px;
    }
    .ipfs-status-text p {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }
    .ipfs-btn {
      padding: 8px 16px;
      border-radius: var(--radius-sm);
      border: none;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .ipfs-btn.start {
      background: linear-gradient(135deg, var(--success), #00aa2a);
      color: #000;
    }
    .ipfs-btn.stop {
      background: linear-gradient(135deg, var(--error), #cc0033);
      color: #fff;
    }
    .ipfs-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .ipfs-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    .ipfs-stat {
      padding: 10px;
      background: var(--bg-dark);
      border-radius: var(--radius-sm);
      text-align: center;
    }
    .ipfs-stat-value {
      font-family: var(--font-mono);
      font-size: 1rem;
      color: var(--primary);
    }
    .ipfs-stat-label {
      font-size: 0.65rem;
      color: var(--text-muted);
      text-transform: uppercase;
      margin-top: 4px;
    }

    /* Drive Selector */
    .drive-selector {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-subtle);
    }
    .drive-selector-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .drive-selector-label span {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }
    .drive-selector-label .drive-info {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }
    .drive-select {
      width: 100%;
      padding: 12px 14px;
      background: var(--bg-dark);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.85rem;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d4ff' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
    }
    .drive-select:hover {
      border-color: var(--border-accent);
    }
    .drive-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 10px rgba(0,212,255,0.2);
    }
    .drive-select option {
      background: var(--bg-card);
      color: var(--text-primary);
      padding: 8px;
    }
    .drive-bar {
      margin-top: 8px;
      height: 4px;
      background: var(--bg-dark);
      border-radius: 2px;
      overflow: hidden;
    }
    .drive-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      transition: width 0.3s;
    }
    .drive-bar-fill.warning { background: linear-gradient(90deg, var(--warning), #ff6600); }
    .drive-bar-fill.danger { background: linear-gradient(90deg, var(--error), #cc0033); }

    /* Buttons */
    .btn {
      padding: 14px 28px;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .btn-start {
      background: linear-gradient(135deg, var(--success), #00aa2a);
      color: #000;
      box-shadow: 0 4px 20px rgba(0,255,65,0.3);
    }
    .btn-start:hover {
      box-shadow: 0 4px 30px rgba(0,255,65,0.5);
      transform: translateY(-1px);
    }
    .btn-stop {
      background: linear-gradient(135deg, var(--error), #cc0033);
      color: #fff;
      box-shadow: 0 4px 20px rgba(255,51,102,0.3);
    }
    .btn-stop:hover {
      box-shadow: 0 4px 30px rgba(255,51,102,0.5);
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }
    .btn-secondary {
      background: var(--bg-elevated);
      border: 1px solid var(--border-accent);
      color: var(--primary);
    }
    .btn-secondary:hover {
      background: rgba(0,212,255,0.1);
    }
    .btn-save {
      background: linear-gradient(135deg, var(--primary), #0099bb);
      color: #000;
      margin-top: 16px;
    }
    .btn-save.saved {
      background: linear-gradient(135deg, var(--success), #00aa2a);
    }

    /* Log */
    .log {
      background: var(--bg-dark);
      border-radius: var(--radius-sm);
      padding: 14px;
      font-family: var(--font-mono);
      font-size: 0.75rem;
      height: 150px;
      overflow-y: auto;
    }
    .log-entry {
      padding: 3px 0;
      color: var(--text-muted);
      display: flex;
      gap: 10px;
    }
    .log-entry .time { color: var(--text-muted); opacity: 0.6; }
    .log-entry.success { color: var(--success); }
    .log-entry.error { color: var(--error); }

    /* Dashboard Button */
    .btn-dashboard {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px;
      background: linear-gradient(135deg, rgba(255,0,255,0.1), rgba(0,212,255,0.1));
      border: 1px solid rgba(255,0,255,0.3);
      border-radius: var(--radius-sm);
      color: var(--primary-light);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 12px;
    }
    .btn-dashboard:hover {
      background: linear-gradient(135deg, rgba(255,0,255,0.2), rgba(0,212,255,0.15));
      box-shadow: 0 0 20px rgba(255,0,255,0.2);
    }

    /* Loading state */
    .loading { text-align: center; color: var(--text-muted); padding: 30px; }
    .spin { animation: spin 1s linear infinite; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    /* Ollama Models */
    .ollama-status {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      margin-bottom: 12px;
    }
    .ollama-status.running {
      background: linear-gradient(135deg, rgba(118,185,0,0.1), rgba(118,185,0,0.05));
      border: 1px solid rgba(118,185,0,0.3);
    }
    .ollama-status-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .ollama-status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--text-muted);
    }
    .ollama-status-dot.online {
      background: #76b900;
      box-shadow: 0 0 8px #76b900;
    }
    .ollama-status-text h4 {
      font-size: 0.85rem;
      margin-bottom: 2px;
    }
    .ollama-status-text p {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }
    .model-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
      max-height: 200px;
      overflow-y: auto;
    }
    .model-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
    }
    .model-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .model-name {
      font-size: 0.85rem;
      font-weight: 600;
      color: #76b900;
    }
    .model-size {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }
    .model-delete-btn {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--error);
      border-radius: var(--radius-sm);
      color: var(--error);
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .model-delete-btn:hover {
      background: rgba(255,51,102,0.1);
    }
    .model-add-section {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    .model-select {
      flex: 1;
      padding: 10px 12px;
      background: var(--bg-dark);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-size: 0.85rem;
    }
    .model-select:focus {
      outline: none;
      border-color: #76b900;
    }
    .model-pull-btn {
      padding: 10px 16px;
      background: linear-gradient(135deg, #76b900, #5a8f00);
      border: none;
      border-radius: var(--radius-sm);
      color: #fff;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .model-pull-btn:hover {
      box-shadow: 0 0 15px rgba(118,185,0,0.4);
    }
    .model-pull-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .model-progress {
      margin-top: 12px;
      padding: 12px;
      background: var(--bg-elevated);
      border-radius: var(--radius-sm);
      display: none;
    }
    .model-progress.visible {
      display: block;
    }
    .model-progress-text {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }
    .model-progress-bar {
      height: 6px;
      background: var(--bg-dark);
      border-radius: 3px;
      overflow: hidden;
    }
    .model-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #76b900, #9be22d);
      width: 0%;
      transition: width 0.3s;
    }
    .empty-models {
      text-align: center;
      padding: 20px;
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg-dark); }
    ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

    /* Setup Wizard Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }
    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }
    .modal {
      background: var(--bg-card);
      border: 1px solid var(--border-accent);
      border-radius: var(--radius);
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      transform: scale(0.9);
      transition: transform 0.3s;
    }
    .modal-overlay.visible .modal {
      transform: scale(1);
    }
    .modal-header {
      padding: 24px;
      text-align: center;
      border-bottom: 1px solid var(--border-subtle);
    }
    .modal-header h2 {
      font-size: 1.3rem;
      margin-bottom: 8px;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .modal-header p {
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .modal-body {
      padding: 24px;
    }
    .modal-footer {
      padding: 16px 24px;
      border-top: 1px solid var(--border-subtle);
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }
    .wizard-step {
      display: none;
    }
    .wizard-step.active {
      display: block;
    }
    .wizard-step-indicator {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 24px;
    }
    .wizard-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--bg-dark);
      border: 2px solid var(--text-muted);
      transition: all 0.3s;
    }
    .wizard-dot.active {
      background: var(--primary);
      border-color: var(--primary);
      box-shadow: 0 0 10px var(--primary);
    }
    .wizard-dot.completed {
      background: var(--success);
      border-color: var(--success);
    }
    .wizard-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(0,212,255,0.1), rgba(255,0,255,0.1));
      border: 2px solid var(--border-accent);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .wizard-icon svg {
      width: 40px;
      height: 40px;
      color: var(--primary);
    }
    .wizard-title {
      text-align: center;
      font-size: 1.1rem;
      margin-bottom: 8px;
    }
    .wizard-desc {
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 24px;
    }
    .progress-container {
      margin: 20px 0;
    }
    .progress-bar {
      height: 8px;
      background: var(--bg-dark);
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      width: 0%;
      transition: width 0.3s;
    }
    .progress-text {
      text-align: center;
      margin-top: 8px;
      font-size: 0.8rem;
      color: var(--text-secondary);
      font-family: var(--font-mono);
    }
    .wizard-select {
      width: 100%;
      padding: 14px 16px;
      background: var(--bg-dark);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.9rem;
      cursor: pointer;
      margin-bottom: 16px;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d4ff' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
    }
    .wizard-select:focus {
      outline: none;
      border-color: var(--primary);
    }
    .wizard-success {
      text-align: center;
      padding: 20px;
    }
    .wizard-success svg {
      width: 60px;
      height: 60px;
      color: var(--success);
      margin-bottom: 16px;
    }
    .btn-wizard {
      padding: 12px 24px;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-wizard-primary {
      background: linear-gradient(135deg, var(--primary), #0099bb);
      color: #000;
    }
    .btn-wizard-primary:hover {
      box-shadow: var(--glow-primary);
    }
    .btn-wizard-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .btn-wizard-secondary {
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
    }
    .btn-wizard-secondary:hover {
      border-color: var(--text-muted);
      color: var(--text-primary);
    }
    .storage-info {
      background: var(--bg-elevated);
      padding: 14px;
      border-radius: var(--radius-sm);
      margin-bottom: 16px;
    }
    .storage-info-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      margin-bottom: 6px;
    }
    .storage-info-row:last-child {
      margin-bottom: 0;
    }
    .storage-info-label {
      color: var(--text-muted);
    }
    .storage-info-value {
      color: var(--primary);
      font-family: var(--font-mono);
    }
  </style>
</head>
<body>
  <!-- Title Bar -->
  <div class="title-bar">
    <div class="title-bar-brand">
      <div class="title-bar-logo">OT</div>
      <span class="title-bar-title">OtherThing Node</span>
    </div>
    <div class="window-controls">
      <button id="min-btn" class="window-btn" title="Minimize">
        <svg width="12" height="12" viewBox="0 0 12 12"><rect y="5" width="12" height="2" fill="currentColor"/></svg>
      </button>
      <button id="max-btn" class="window-btn" title="Maximize">
        <svg width="12" height="12" viewBox="0 0 12 12"><rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>
      </button>
      <button id="close-btn" class="window-btn close" title="Close">
        <svg width="12" height="12" viewBox="0 0 12 12"><path d="M2 2L10 10M10 2L2 10" stroke="currentColor" stroke-width="1.5"/></svg>
      </button>
    </div>
  </div>

  <!-- Setup Wizard Modal -->
  <div id="setup-wizard-overlay" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2>Node Setup</h2>
        <p>Configure your compute node for OtherThing</p>
      </div>
      <div class="modal-body">
        <div class="wizard-step-indicator">
          <div id="wizard-dot-1" class="wizard-dot active"></div>
          <div id="wizard-dot-2" class="wizard-dot"></div>
          <div id="wizard-dot-3" class="wizard-dot"></div>
          <div id="wizard-dot-4" class="wizard-dot"></div>
          <div id="wizard-dot-5" class="wizard-dot"></div>
        </div>

        <!-- Step 1: Welcome -->
        <div id="wizard-step-1" class="wizard-step active">
          <div class="wizard-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
              <line x1="9" y1="9" x2="9.01" y2="9"/>
              <line x1="15" y1="9" x2="15.01" y2="9"/>
            </svg>
          </div>
          <h3 class="wizard-title">Welcome to OtherThing Node</h3>
          <p class="wizard-desc">Let's set up your node to contribute compute power to workspaces. This wizard will configure storage and AI capabilities.</p>
          <div class="storage-info" style="margin-top:20px;">
            <div class="storage-info-row">
              <span class="storage-info-label">What we'll set up:</span>
            </div>
            <div class="storage-info-row">
              <span class="storage-info-label">1. Storage Location</span>
              <span class="storage-info-value">Where to store data</span>
            </div>
            <div class="storage-info-row">
              <span class="storage-info-label">2. IPFS</span>
              <span class="storage-info-value">Distributed file storage</span>
            </div>
            <div class="storage-info-row">
              <span class="storage-info-label">3. Ollama</span>
              <span class="storage-info-value">Local AI models</span>
            </div>
          </div>
        </div>

        <!-- Step 2: Select Storage -->
        <div id="wizard-step-2" class="wizard-step">
          <div class="wizard-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
              <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
              <line x1="12" y1="22.08" x2="12" y2="12"/>
            </svg>
          </div>
          <h3 class="wizard-title">Select Storage Location</h3>
          <p class="wizard-desc">Choose where to store IPFS data and AI models. Select a drive with enough free space.</p>
          <select id="wizard-drive-select" class="wizard-select">
            <option value="">Loading drives...</option>
          </select>
          <div id="wizard-storage-info" class="storage-info" style="display:none;">
            <div class="storage-info-row">
              <span class="storage-info-label">Drive</span>
              <span id="wizard-drive-name" class="storage-info-value">-</span>
            </div>
            <div class="storage-info-row">
              <span class="storage-info-label">Free Space</span>
              <span id="wizard-drive-free" class="storage-info-value">-</span>
            </div>
            <div class="storage-info-row">
              <span class="storage-info-label">Storage Path</span>
              <span id="wizard-storage-path" class="storage-info-value">-</span>
            </div>
          </div>
        </div>

        <!-- Step 3: Setup IPFS -->
        <div id="wizard-step-3" class="wizard-step">
          <div class="wizard-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
          </div>
          <h3 class="wizard-title">Setup IPFS</h3>
          <p class="wizard-desc" id="ipfs-setup-desc">IPFS enables distributed file storage across your workspace. We'll download the IPFS binary (~50MB).</p>
          <div id="ipfs-download-progress" class="progress-container" style="display:none;">
            <div class="progress-bar">
              <div id="ipfs-download-progress-fill" class="progress-fill"></div>
            </div>
            <div id="ipfs-download-progress-text" class="progress-text">Downloading... 0%</div>
          </div>
          <div id="ipfs-setup-status" class="storage-info" style="display:none;margin-top:16px;">
            <div class="storage-info-row">
              <span class="storage-info-label">IPFS Status</span>
              <span id="ipfs-setup-status-text" class="storage-info-value">-</span>
            </div>
          </div>
        </div>

        <!-- Step 4: Setup Ollama -->
        <div id="wizard-step-4" class="wizard-step">
          <div class="wizard-icon" style="border-color: rgba(118,185,0,0.5);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#76b900;">
              <rect x="4" y="4" width="16" height="16" rx="2"/>
              <rect x="9" y="9" width="6" height="6"/>
              <line x1="9" y1="1" x2="9" y2="4"/>
              <line x1="15" y1="1" x2="15" y2="4"/>
              <line x1="9" y1="20" x2="9" y2="23"/>
              <line x1="15" y1="20" x2="15" y2="23"/>
            </svg>
          </div>
          <h3 class="wizard-title">Setup Ollama</h3>
          <p class="wizard-desc" id="ollama-setup-desc">Ollama lets you run AI models locally. This enables AI capabilities for your workspaces.</p>
          <div id="ollama-gpu-info" class="storage-info" style="margin-bottom:16px;">
            <div class="storage-info-row">
              <span class="storage-info-label">GPU Detected</span>
              <span id="wizard-gpu-name" class="storage-info-value" style="color:#76b900;">Checking...</span>
            </div>
          </div>
          <div id="ollama-download-progress" class="progress-container" style="display:none;">
            <div class="progress-bar">
              <div id="ollama-download-progress-fill" class="progress-fill" style="background: linear-gradient(90deg, #76b900, #9be22d);"></div>
            </div>
            <div id="ollama-download-progress-text" class="progress-text">Installing... 0%</div>
          </div>
          <div id="ollama-browse-section" style="display:none;margin-top:16px;">
            <p style="font-size:0.8rem;color:var(--text-muted);margin-bottom:12px;">Ollama not auto-detected. If you installed it, browse to select ollama.exe:</p>
            <div style="display:flex;gap:8px;">
              <input type="text" id="ollama-path-input" readonly placeholder="Click Browse to select ollama.exe" style="flex:1;padding:10px 12px;background:var(--bg-dark);border:1px solid var(--border-subtle);border-radius:var(--radius-sm);color:var(--text-primary);font-size:0.8rem;">
              <button id="ollama-browse-btn" class="btn-wizard btn-wizard-secondary" style="padding:10px 16px;">Browse</button>
            </div>
          </div>
          <div id="ollama-setup-status" class="storage-info" style="display:none;margin-top:16px;">
            <div class="storage-info-row">
              <span class="storage-info-label">Ollama Status</span>
              <span id="ollama-setup-status-text" class="storage-info-value">-</span>
            </div>
            <div class="storage-info-row" id="ollama-path-row" style="display:none;">
              <span class="storage-info-label">Path</span>
              <span id="ollama-path-display" class="storage-info-value" style="font-size:0.7rem;word-break:break-all;">-</span>
            </div>
          </div>
        </div>

        <!-- Step 5: Complete -->
        <div id="wizard-step-5" class="wizard-step">
          <div class="wizard-success">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <h3 class="wizard-title">Setup Complete!</h3>
            <p class="wizard-desc">Your node is ready to contribute compute to workspaces.</p>
            <div id="wizard-final-info" class="storage-info" style="margin-top:20px;">
              <div class="storage-info-row">
                <span class="storage-info-label">Storage</span>
                <span id="wizard-final-path" class="storage-info-value">-</span>
              </div>
              <div class="storage-info-row">
                <span class="storage-info-label">IPFS</span>
                <span id="wizard-final-ipfs" class="storage-info-value">-</span>
              </div>
              <div class="storage-info-row">
                <span class="storage-info-label">Ollama</span>
                <span id="wizard-final-ollama" class="storage-info-value">-</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="wizard-skip-btn" class="btn-wizard btn-wizard-secondary">Skip for now</button>
        <button id="wizard-next-btn" class="btn-wizard btn-wizard-primary">Get Started</button>
      </div>
    </div>
  </div>

  <div class="main-content">
    <!-- Status Banner -->
    <div id="status-banner" class="status-banner">
      <div class="status-info">
        <div id="status-icon" class="status-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
        </div>
        <div class="status-text">
          <h2 id="status-title">Node Starting...</h2>
          <p id="status-subtitle">Initializing local services</p>
        </div>
      </div>
      <div class="status-indicators">
        <div class="indicator">
          <div id="local-dot" class="indicator-dot online"></div>
          <span>Local</span>
        </div>
        <div class="indicator">
          <div id="network-dot" class="indicator-dot"></div>
          <span>Network</span>
        </div>
      </div>
    </div>

    <!-- Share Key -->
    <div id="share-key-card" class="card share-key-card">
      <div class="card-body">
        <div class="share-key-label">Your Share Key</div>
        <div id="share-key-value" class="share-key-value">--------</div>
        <div class="share-key-hint">Give this key to workspace admins to add your node</div>
        <button id="copy-key-btn" class="btn-copy">Copy to Clipboard</button>
      </div>
    </div>

    <!-- Control -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          Node Control
        </div>
        <span style="font-size:0.7rem;color:var(--success);">Local Mode Active</span>
      </div>
      <div class="card-body">
        <div style="padding: 12px; background: rgba(0,255,65,0.05); border: 1px solid rgba(0,255,65,0.2); border-radius: 8px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
            <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--success); box-shadow: 0 0 8px var(--success);"></div>
            <span style="font-size: 0.85rem; font-weight: 500;">Running Locally</span>
          </div>
          <p style="font-size: 0.75rem; color: var(--text-muted); margin-left: 16px;">
            API server at http://localhost:8080 â€” All features work without network
          </p>
        </div>

        <div id="network-section" style="padding-top: 12px; border-top: 1px solid var(--border-subtle);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
            <span style="font-size: 0.8rem; color: var(--text-secondary);">Join Network (Optional)</span>
            <span id="network-status-text" style="font-size: 0.7rem; color: var(--text-muted);">Not connected</span>
          </div>
          <div id="network-url-section" style="margin-bottom: 12px;">
            <input type="text" id="orchestrator-url" value="ws://155.117.46.228/ws/node"
              style="width: 100%; padding: 8px 12px; background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: 6px; color: var(--text-primary); font-family: var(--font-mono); font-size: 0.8rem;"
              placeholder="ws://155.117.46.228/ws/node">
            <div style="margin-top: 4px; font-size: 0.65rem; color: var(--text-muted);">
              Connect to share compute with others or access remote workspaces
            </div>
          </div>
          <button id="join-network-btn" class="btn btn-start">Join Network</button>
          <button id="leave-network-btn" class="btn btn-stop" style="display:none;">Leave Network</button>
        </div>

        <button id="open-dashboard-btn" class="btn-dashboard" style="margin-top: 16px;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
            <polyline points="15 3 21 3 21 9"/>
            <line x1="10" y1="14" x2="21" y2="3"/>
          </svg>
          Open Web Dashboard
        </button>
      </div>
    </div>

    <!-- Hardware -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="20" y1="15" x2="23" y2="15"/><line x1="1" y1="9" x2="4" y2="9"/><line x1="1" y1="15" x2="4" y2="15"/></svg>
          Hardware
        </div>
      </div>
      <div class="card-body">
        <div id="hardware-info" class="loading">Detecting hardware...</div>
      </div>
    </div>

    <!-- Resource Limits -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
          Resource Limits
        </div>
        <span style="font-size:0.7rem;color:var(--text-muted)">Control how much to share</span>
      </div>
      <div class="card-body">
        <!-- Drive Selector -->
        <div class="drive-selector">
          <div class="drive-selector-label">
            <span>Storage Drive</span>
            <span id="drive-info" class="drive-info">Select a drive</span>
          </div>
          <select id="drive-select" class="drive-select">
            <option value="">Loading drives...</option>
          </select>
          <div class="drive-bar">
            <div id="drive-bar-fill" class="drive-bar-fill" style="width: 0%"></div>
          </div>
        </div>

        <div class="limit-row">
          <span class="limit-label">CPU Cores</span>
          <input type="range" class="limit-slider" id="cpu-slider" min="1" max="16" value="16">
          <span class="limit-value"><span id="cpu-value">All</span> / <span id="cpu-max">16</span></span>
        </div>
        <div class="limit-row">
          <span class="limit-label">RAM</span>
          <input type="range" class="limit-slider" id="ram-slider" min="10" max="100" value="100" step="5">
          <span class="limit-value"><span id="ram-value">100</span>%</span>
        </div>
        <div class="limit-row">
          <span class="limit-label">Storage</span>
          <input type="range" class="limit-slider" id="storage-slider" min="10" max="500" value="500" step="10">
          <span class="limit-value"><span id="storage-value">All</span> / <span id="storage-max">500</span> GB</span>
        </div>
        <div class="limit-row" id="gpu-limit-row" style="display:none;">
          <span class="limit-label">GPU VRAM</span>
          <input type="range" class="limit-slider" id="gpu-slider" min="10" max="100" value="100" step="5">
          <span class="limit-value"><span id="gpu-value">100</span>%</span>
        </div>
        <button id="save-limits-btn" class="btn btn-save">Save Limits</button>
      </div>
    </div>

    <!-- IPFS Storage -->
    <div class="card" id="ipfs-card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
          IPFS Storage
        </div>
        <span id="ipfs-binary-status" style="font-size:0.65rem;color:var(--text-muted)">Checking...</span>
      </div>
      <div class="card-body">
        <div id="ipfs-status-box" class="ipfs-status">
          <div class="ipfs-status-info">
            <div id="ipfs-dot" class="ipfs-status-dot"></div>
            <div class="ipfs-status-text">
              <h4 id="ipfs-title">IPFS Offline</h4>
              <p id="ipfs-peer-id">Select a storage drive first</p>
            </div>
          </div>
          <button id="ipfs-toggle-btn" class="ipfs-btn start" disabled>Start</button>
        </div>
        <div id="ipfs-stats-box" class="ipfs-stats" style="display:none;">
          <div class="ipfs-stat">
            <div id="ipfs-repo-size" class="ipfs-stat-value">0 MB</div>
            <div class="ipfs-stat-label">Repo Size</div>
          </div>
          <div class="ipfs-stat">
            <div id="ipfs-objects" class="ipfs-stat-value">0</div>
            <div class="ipfs-stat-label">Objects</div>
          </div>
          <div class="ipfs-stat">
            <div id="ipfs-peers" class="ipfs-stat-value">0</div>
            <div class="ipfs-stat-label">Peers</div>
          </div>
        </div>
        <div id="ipfs-limit-section" class="limit-row" style="margin-top:12px;padding-top:12px;border-top:1px solid var(--border-subtle);">
          <span class="limit-label">Max Storage</span>
          <input type="range" class="limit-slider" id="ipfs-limit-slider" min="5" max="500" value="50" step="5">
          <span class="limit-value"><span id="ipfs-limit-value">50</span> GB</span>
          <button id="ipfs-limit-save-btn" class="btn btn-save" style="margin-left:8px;padding:6px 12px;font-size:0.7rem;">Apply</button>
        </div>
      </div>
    </div>

    <!-- Ollama AI Models -->
    <div class="card" id="ollama-card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#76b900;"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/></svg>
          Ollama AI Models
        </div>
        <span id="ollama-status-badge" style="font-size:0.65rem;color:var(--text-muted)">Checking...</span>
      </div>
      <div class="card-body">
        <div id="ollama-status-box" class="ollama-status">
          <div class="ollama-status-info">
            <div id="ollama-dot" class="ollama-status-dot"></div>
            <div class="ollama-status-text">
              <h4 id="ollama-title">Ollama Offline</h4>
              <p id="ollama-endpoint">Not running</p>
            </div>
          </div>
          <button id="ollama-toggle-btn" class="ipfs-btn start" disabled>Start</button>
        </div>

        <div id="model-list" class="model-list">
          <div class="empty-models">No models installed</div>
        </div>

        <div id="model-progress" class="model-progress">
          <div id="model-progress-text" class="model-progress-text">Downloading...</div>
          <div class="model-progress-bar">
            <div id="model-progress-fill" class="model-progress-fill"></div>
          </div>
        </div>

        <div class="model-add-section">
          <select id="model-select" class="model-select">
            <option value="">-- Select a model to install --</option>
            <option value="llama3.2:1b">Llama 3.2 1B (1.3 GB) - Fast, lightweight</option>
            <option value="llama3.2:3b">Llama 3.2 3B (2.0 GB) - Balanced</option>
            <option value="llama3.1:8b">Llama 3.1 8B (4.7 GB) - Powerful</option>
            <option value="mistral:7b">Mistral 7B (4.1 GB) - Great quality</option>
            <option value="codellama:7b">Code Llama 7B (3.8 GB) - Code generation</option>
            <option value="phi3:mini">Phi-3 Mini (2.3 GB) - Microsoft</option>
            <option value="gemma2:2b">Gemma 2 2B (1.6 GB) - Google</option>
            <option value="qwen2.5:3b">Qwen 2.5 3B (1.9 GB) - Alibaba</option>
            <option value="deepseek-coder:6.7b">DeepSeek Coder (3.8 GB) - Code</option>
          </select>
          <button id="model-pull-btn" class="model-pull-btn" disabled>Pull Model</button>
        </div>
      </div>
    </div>

    <!-- Workspaces -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          Workspaces
        </div>
      </div>
      <div class="card-body">
        <div id="workspace-list" class="workspace-list">
          <div class="workspace-empty">Start node to see assigned workspaces</div>
        </div>
      </div>
    </div>

    <!-- Settings -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          Settings
        </div>
      </div>
      <div class="card-body">
        <div class="setting-row">
          <div class="setting-info">
            <h4>Remote Control</h4>
            <p>Allow workspace admins to manage this node from the dashboard</p>
          </div>
          <div id="remote-toggle" class="toggle"></div>
        </div>
      </div>
    </div>

    <!-- Log -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
          Activity Log
        </div>
      </div>
      <div class="card-body">
        <div id="log" class="log"></div>
      </div>
    </div>
  </div>

  <script>
    if (typeof window.electronAPI === 'undefined') {
      document.getElementById('hardware-info').innerHTML = '<div style="color:var(--error)">Error: electronAPI not available</div>';
    } else {
      const log = document.getElementById('log');
      const statusBanner = document.getElementById('status-banner');
      const statusIcon = document.getElementById('status-icon');
      const statusTitle = document.getElementById('status-title');
      const statusSubtitle = document.getElementById('status-subtitle');
      const localDot = document.getElementById('local-dot');
      const networkDot = document.getElementById('network-dot');
      const shareKeyCard = document.getElementById('share-key-card');
      const shareKeyValue = document.getElementById('share-key-value');
      const copyKeyBtn = document.getElementById('copy-key-btn');
      const workspaceList = document.getElementById('workspace-list');
      const joinNetworkBtn = document.getElementById('join-network-btn');
      const leaveNetworkBtn = document.getElementById('leave-network-btn');
      const networkStatusText = document.getElementById('network-status-text');

      function addLog(msg, type = 'info') {
        const entry = document.createElement('div');
        entry.className = 'log-entry ' + type;
        const time = new Date().toLocaleTimeString('en-US', { hour12: false });
        entry.innerHTML = `<span class="time">${time}</span><span>${msg}</span>`;
        log.insertBefore(entry, log.firstChild);
      }

      // Hardware detection
      addLog('Detecting hardware...');
      window.electronAPI.getHardware().then(hw => {
        addLog('Hardware detected', 'success');

        let html = '<div class="hw-grid">';
        html += `<div class="hw-item"><div class="hw-label">Processor</div><div class="hw-value secondary">${hw.cpu.model}</div></div>`;
        html += `<div class="hw-item"><div class="hw-label">CPU Cores</div><div class="hw-value">${hw.cpu.cores} cores / ${hw.cpu.threads} threads</div></div>`;
        html += `<div class="hw-item"><div class="hw-label">Memory</div><div class="hw-value">${(hw.memory.total_mb / 1024).toFixed(1)} GB</div></div>`;
        html += `<div class="hw-item"><div class="hw-label">Storage</div><div class="hw-value">${hw.storage.total_gb} GB (${hw.storage.available_gb} GB free)</div></div>`;
        html += '</div>';

        if (hw.gpus && hw.gpus.length > 0) {
          html += '<div class="gpu-list">';
          hw.gpus.forEach(gpu => {
            const vendor = gpu.vendor?.toLowerCase() || 'unknown';
            html += `<div class="gpu-item">
              <span class="gpu-badge ${vendor === 'amd' ? 'amd' : ''}">${vendor}</span>
              <span class="gpu-name">${gpu.model}</span>
              <span class="gpu-vram">${(gpu.vram_mb / 1024).toFixed(0)} GB</span>
            </div>`;
          });
          html += '</div>';
        }

        document.getElementById('hardware-info').innerHTML = html;

        // Setup sliders
        document.getElementById('cpu-slider').max = hw.cpu.cores;
        document.getElementById('cpu-slider').value = hw.cpu.cores;
        document.getElementById('cpu-max').textContent = hw.cpu.cores;

        const maxStorage = Math.round(hw.storage.available_gb);
        document.getElementById('storage-slider').max = maxStorage;
        document.getElementById('storage-slider').value = maxStorage;
        document.getElementById('storage-max').textContent = maxStorage;

        if (hw.gpus && hw.gpus.length > 0) {
          document.getElementById('gpu-limit-row').style.display = 'flex';
        }

        updateSliderDisplays();
      }).catch(err => {
        addLog('Hardware detection failed: ' + err, 'error');
        document.getElementById('hardware-info').innerHTML = '<div style="color:var(--error)">Failed to detect hardware</div>';
      });

      // Node is auto-started in local mode - update UI to reflect this
      statusBanner.classList.add('connected');
      statusIcon.classList.add('online');
      statusTitle.textContent = 'Node Active';
      statusSubtitle.textContent = 'Running locally on http://localhost:8080';
      localDot.className = 'indicator-dot online';

      // Join network (optional)
      joinNetworkBtn.addEventListener('click', async () => {
        joinNetworkBtn.disabled = true;
        addLog('Joining network...');
        networkDot.className = 'indicator-dot connecting';
        networkStatusText.textContent = 'Connecting...';
        try {
          const orchestratorUrl = document.getElementById('orchestrator-url').value.trim();
          addLog(`Connecting to ${orchestratorUrl}...`);
          const result = await window.electronAPI.connectToNetwork({ url: orchestratorUrl, workspaceIds: [] });
          if (result.success) {
            addLog('Joined network', 'success');
            joinNetworkBtn.style.display = 'none';
            leaveNetworkBtn.style.display = 'block';
            networkStatusText.textContent = 'Connected';
            networkStatusText.style.color = 'var(--success)';
          } else {
            addLog('Failed: ' + result.error, 'error');
            joinNetworkBtn.disabled = false;
            networkDot.className = 'indicator-dot';
            networkStatusText.textContent = 'Connection failed';
            networkStatusText.style.color = 'var(--error)';
          }
        } catch (err) {
          addLog('Error: ' + err, 'error');
          joinNetworkBtn.disabled = false;
          networkDot.className = 'indicator-dot';
          networkStatusText.textContent = 'Error';
          networkStatusText.style.color = 'var(--error)';
        }
      });

      // Leave network
      leaveNetworkBtn.addEventListener('click', async () => {
        leaveNetworkBtn.disabled = true;
        addLog('Leaving network...');
        await window.electronAPI.disconnectFromNetwork();
        addLog('Disconnected from network (local mode still active)');
        leaveNetworkBtn.style.display = 'none';
        joinNetworkBtn.style.display = 'block';
        joinNetworkBtn.disabled = false;
        leaveNetworkBtn.disabled = false;

        networkDot.className = 'indicator-dot';
        networkStatusText.textContent = 'Not connected';
        networkStatusText.style.color = 'var(--text-muted)';
      });

      // Status updates
      window.electronAPI.onNodeStatus(status => {
        // Local mode is always on when app is running
        if (status.running) {
          localDot.className = 'indicator-dot online';
          statusBanner.classList.add('connected');
          statusIcon.classList.add('online');
          statusTitle.textContent = 'Node Active';

          // Update network connection status
          if (status.connected) {
            networkDot.className = 'indicator-dot online';
            statusSubtitle.textContent = status.nodeId ? `${status.nodeId} (networked)` : 'Connected to network';
            networkStatusText.textContent = 'Connected';
            networkStatusText.style.color = 'var(--success)';
            joinNetworkBtn.style.display = 'none';
            leaveNetworkBtn.style.display = 'block';
          } else {
            networkDot.className = 'indicator-dot';
            statusSubtitle.textContent = 'Running locally on http://localhost:8080';
            networkStatusText.textContent = 'Not connected';
            networkStatusText.style.color = 'var(--text-muted)';
            joinNetworkBtn.style.display = 'block';
            leaveNetworkBtn.style.display = 'none';
          }

          if (status.shareKey) {
            shareKeyValue.textContent = status.shareKey;
            shareKeyCard.classList.add('visible');
          }

          updateWorkspaceDisplay(status.workspaceIds || []);
        } else {
          // This shouldn't happen in normal operation since local mode auto-starts
          localDot.className = 'indicator-dot';
          networkDot.className = 'indicator-dot';
          statusBanner.classList.remove('connected');
          statusIcon.classList.remove('online');
          statusTitle.textContent = 'Node Starting...';
          statusSubtitle.textContent = 'Initializing local services';
        }
      });

      function updateWorkspaceDisplay(workspaceIds) {
        if (!workspaceIds || workspaceIds.length === 0) {
          workspaceList.innerHTML = '<div class="workspace-empty">Not assigned to any workspaces yet.<br>Share your key with workspace admins to join.</div>';
          return;
        }
        workspaceList.innerHTML = workspaceIds.map(id => `
          <div class="workspace-item assigned">
            <div class="workspace-dot"></div>
            <span class="workspace-name">${id}</span>
          </div>
        `).join('');
      }

      // Copy key
      copyKeyBtn.addEventListener('click', async () => {
        const key = shareKeyValue.textContent;
        if (key && key !== '--------') {
          try {
            await navigator.clipboard.writeText(key);
            copyKeyBtn.textContent = 'Copied!';
            copyKeyBtn.classList.add('copied');
            setTimeout(() => {
              copyKeyBtn.textContent = 'Copy to Clipboard';
              copyKeyBtn.classList.remove('copied');
            }, 2000);
          } catch (err) {
            addLog('Copy failed: ' + err, 'error');
          }
        }
      });

      window.electronAPI.onNodeLog(entry => {
        addLog(entry.message, entry.type);
      });

      // Drive Selector
      const driveSelect = document.getElementById('drive-select');
      const driveInfo = document.getElementById('drive-info');
      const driveBarFill = document.getElementById('drive-bar-fill');
      let drives = [];

      async function loadDrives() {
        try {
          drives = await window.electronAPI.getDrives();
          const savedPath = await window.electronAPI.getStoragePath();

          driveSelect.innerHTML = '<option value="">-- Select a drive --</option>';
          drives.forEach(drive => {
            const opt = document.createElement('option');
            opt.value = drive.mount;
            opt.textContent = `${drive.mount} - ${drive.available_gb} GB free of ${drive.size_gb} GB (${drive.type})`;
            if (savedPath === drive.mount) {
              opt.selected = true;
            }
            driveSelect.appendChild(opt);
          });

          // Update display for saved selection
          if (savedPath) {
            const selectedDrive = drives.find(d => d.mount === savedPath);
            if (selectedDrive) {
              updateDriveDisplay(selectedDrive);
            }
          }

          addLog('Drives detected: ' + drives.length, 'success');
        } catch (err) {
          addLog('Failed to load drives: ' + err, 'error');
          driveSelect.innerHTML = '<option value="">Error loading drives</option>';
        }
      }

      function updateDriveDisplay(drive) {
        if (!drive) {
          driveInfo.textContent = 'Select a drive';
          driveBarFill.style.width = '0%';
          driveBarFill.className = 'drive-bar-fill';
          return;
        }

        driveInfo.textContent = `${drive.available_gb} GB free / ${drive.size_gb} GB total`;
        driveBarFill.style.width = `${drive.used_percent}%`;

        // Color based on usage
        driveBarFill.className = 'drive-bar-fill';
        if (drive.used_percent > 90) {
          driveBarFill.classList.add('danger');
        } else if (drive.used_percent > 75) {
          driveBarFill.classList.add('warning');
        }

        // Update storage slider max based on selected drive
        const maxStorage = Math.round(drive.available_gb);
        document.getElementById('storage-slider').max = maxStorage;
        document.getElementById('storage-max').textContent = maxStorage;
        if (parseInt(storageSlider.value) > maxStorage) {
          storageSlider.value = maxStorage;
        }
        updateSliderDisplays();
      }

      driveSelect.addEventListener('change', async () => {
        const selectedMount = driveSelect.value;
        const selectedDrive = drives.find(d => d.mount === selectedMount);

        updateDriveDisplay(selectedDrive);

        try {
          const result = await window.electronAPI.setStoragePath(selectedMount || null);
          if (result.success) {
            addLog('Storage drive set to: ' + (selectedMount || 'none'), 'success');
            // Refresh IPFS status to update button state
            setTimeout(updateIPFSStatus, 500);
          } else {
            addLog('Failed to set storage drive: ' + result.error, 'error');
          }
        } catch (err) {
          addLog('Error setting storage drive: ' + err, 'error');
        }
      });

      // Load drives on startup
      loadDrives();

      // IPFS Controls
      const ipfsBinaryStatus = document.getElementById('ipfs-binary-status');
      const ipfsStatusBox = document.getElementById('ipfs-status-box');
      const ipfsDot = document.getElementById('ipfs-dot');
      const ipfsTitle = document.getElementById('ipfs-title');
      const ipfsPeerId = document.getElementById('ipfs-peer-id');
      const ipfsToggleBtn = document.getElementById('ipfs-toggle-btn');
      const ipfsStatsBox = document.getElementById('ipfs-stats-box');
      const ipfsRepoSize = document.getElementById('ipfs-repo-size');
      const ipfsObjects = document.getElementById('ipfs-objects');
      const ipfsPeers = document.getElementById('ipfs-peers');
      let ipfsRunning = false;

      async function updateIPFSStatus() {
        try {
          const status = await window.electronAPI.getIPFSStatus();

          // Update binary status
          if (status.hasBinary) {
            ipfsBinaryStatus.textContent = 'Binary ready';
            ipfsBinaryStatus.style.color = 'var(--success)';
          } else {
            ipfsBinaryStatus.textContent = 'Binary not found';
            ipfsBinaryStatus.style.color = 'var(--error)';
          }

          ipfsRunning = status.running;

          if (status.running) {
            ipfsStatusBox.classList.add('running');
            ipfsDot.classList.add('online');
            ipfsTitle.textContent = 'IPFS Running';
            ipfsPeerId.textContent = status.peerId ? status.peerId.slice(0, 20) + '...' : 'Getting peer ID...';
            ipfsToggleBtn.textContent = 'Stop';
            ipfsToggleBtn.className = 'ipfs-btn stop';
            ipfsStatsBox.style.display = 'grid';

            // Update stats
            if (status.stats) {
              const sizeMB = Math.round(status.stats.repoSize / (1024 * 1024));
              ipfsRepoSize.textContent = sizeMB > 1024 ? (sizeMB / 1024).toFixed(1) + ' GB' : sizeMB + ' MB';
              ipfsObjects.textContent = status.stats.numObjects || '0';
              ipfsPeers.textContent = status.stats.addresses?.length || '0';
            }
          } else {
            ipfsStatusBox.classList.remove('running');
            ipfsDot.classList.remove('online');
            ipfsTitle.textContent = 'IPFS Offline';
            ipfsPeerId.textContent = driveSelect.value ? 'Ready to start' : 'Select a storage drive first';
            ipfsToggleBtn.textContent = 'Start';
            ipfsToggleBtn.className = 'ipfs-btn start';
            ipfsStatsBox.style.display = 'none';
          }

          // Enable button only if we have a drive selected and binary exists
          ipfsToggleBtn.disabled = !driveSelect.value || !status.hasBinary;

        } catch (err) {
          console.error('Failed to get IPFS status:', err);
        }
      }

      ipfsToggleBtn.addEventListener('click', async () => {
        ipfsToggleBtn.disabled = true;

        try {
          if (ipfsRunning) {
            addLog('Stopping IPFS...', 'info');
            const result = await window.electronAPI.stopIPFS();
            if (!result.success) {
              addLog('Failed to stop IPFS: ' + result.error, 'error');
            }
          } else {
            addLog('Starting IPFS...', 'info');
            const result = await window.electronAPI.startIPFS();
            if (!result.success) {
              addLog('Failed to start IPFS: ' + result.error, 'error');
            }
          }
        } catch (err) {
          addLog('IPFS error: ' + err, 'error');
        }

        // Refresh status after a short delay
        setTimeout(updateIPFSStatus, 1000);
        ipfsToggleBtn.disabled = false;
      });

      // Listen for IPFS status updates
      window.electronAPI.onIPFSStatus((status) => {
        updateIPFSStatus();
      });

      // Check IPFS status on load
      updateIPFSStatus();

      // Refresh IPFS stats periodically when running
      setInterval(() => {
        if (ipfsRunning) {
          updateIPFSStatus();
        }
      }, 10000);

      // IPFS Storage Limit
      const ipfsLimitSlider = document.getElementById('ipfs-limit-slider');
      const ipfsLimitValue = document.getElementById('ipfs-limit-value');
      const ipfsLimitSaveBtn = document.getElementById('ipfs-limit-save-btn');

      ipfsLimitSlider.addEventListener('input', () => {
        ipfsLimitValue.textContent = ipfsLimitSlider.value;
      });

      ipfsLimitSaveBtn.addEventListener('click', async () => {
        const limitGb = parseInt(ipfsLimitSlider.value);
        ipfsLimitSaveBtn.disabled = true;
        ipfsLimitSaveBtn.textContent = 'Saving...';

        try {
          const result = await window.electronAPI.setIPFSStorageLimit(limitGb);
          if (result.success) {
            addLog(`IPFS storage limit set to ${limitGb} GB`, 'success');
            ipfsLimitSaveBtn.textContent = 'Saved!';
            setTimeout(() => {
              ipfsLimitSaveBtn.textContent = 'Apply';
              ipfsLimitSaveBtn.disabled = false;
            }, 1500);
          } else {
            addLog('Failed to set IPFS limit: ' + result.error, 'error');
            ipfsLimitSaveBtn.textContent = 'Apply';
            ipfsLimitSaveBtn.disabled = false;
          }
        } catch (err) {
          addLog('Error: ' + err, 'error');
          ipfsLimitSaveBtn.textContent = 'Apply';
          ipfsLimitSaveBtn.disabled = false;
        }
      });

      // Load current IPFS storage limit
      async function loadIPFSStorageLimit() {
        try {
          const limit = await window.electronAPI.getIPFSStorageLimit();
          if (limit !== null) {
            ipfsLimitSlider.value = Math.round(limit);
            ipfsLimitValue.textContent = Math.round(limit);
          }
        } catch (e) {
          // Ignore errors on initial load
        }
      }
      loadIPFSStorageLimit();

      // ===== OLLAMA CONTROLS =====
      const ollamaStatusBadge = document.getElementById('ollama-status-badge');
      const ollamaStatusBox = document.getElementById('ollama-status-box');
      const ollamaDot = document.getElementById('ollama-dot');
      const ollamaTitle = document.getElementById('ollama-title');
      const ollamaEndpoint = document.getElementById('ollama-endpoint');
      const ollamaToggleBtn = document.getElementById('ollama-toggle-btn');
      const modelList = document.getElementById('model-list');
      const modelSelect = document.getElementById('model-select');
      const modelPullBtn = document.getElementById('model-pull-btn');
      const modelProgress = document.getElementById('model-progress');
      const modelProgressText = document.getElementById('model-progress-text');
      const modelProgressFill = document.getElementById('model-progress-fill');
      let ollamaRunning = false;
      let ollamaInstalled = false;

      function formatBytes(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }

      async function updateOllamaUI() {
        try {
          const status = await window.electronAPI.getOllamaStatus();
          ollamaInstalled = status.installed;
          ollamaRunning = status.running;

          // Update status badge
          if (!status.installed) {
            ollamaStatusBadge.textContent = 'Not installed';
            ollamaStatusBadge.style.color = 'var(--error)';
          } else if (status.running) {
            ollamaStatusBadge.textContent = 'Running';
            ollamaStatusBadge.style.color = '#76b900';
          } else {
            ollamaStatusBadge.textContent = 'Stopped';
            ollamaStatusBadge.style.color = 'var(--warning)';
          }

          // Update status box
          if (status.running) {
            ollamaStatusBox.classList.add('running');
            ollamaDot.classList.add('online');
            ollamaTitle.textContent = 'Ollama Running';
            ollamaEndpoint.textContent = status.endpoint || 'http://127.0.0.1:11434';
            ollamaToggleBtn.textContent = 'Stop';
            ollamaToggleBtn.className = 'ipfs-btn stop';
            ollamaToggleBtn.disabled = false;
            modelPullBtn.disabled = !modelSelect.value;
          } else {
            ollamaStatusBox.classList.remove('running');
            ollamaDot.classList.remove('online');
            ollamaTitle.textContent = status.installed ? 'Ollama Stopped' : 'Ollama Not Installed';
            ollamaEndpoint.textContent = status.installed ? 'Click Start to begin' : 'Install Ollama to use AI models';
            ollamaToggleBtn.textContent = 'Start';
            ollamaToggleBtn.className = 'ipfs-btn start';
            ollamaToggleBtn.disabled = !status.installed;
            modelPullBtn.disabled = true;
          }

          // Update model list
          if (status.models && status.models.length > 0) {
            modelList.innerHTML = status.models.map(model => `
              <div class="model-item">
                <div class="model-info">
                  <span class="model-name">${model.name}</span>
                  <span class="model-size">${formatBytes(model.size)}${model.parameterSize ? ' â€¢ ' + model.parameterSize : ''}</span>
                </div>
                <button class="model-delete-btn" data-model="${model.name}">Delete</button>
              </div>
            `).join('');

            // Add delete handlers
            modelList.querySelectorAll('.model-delete-btn').forEach(btn => {
              btn.addEventListener('click', async () => {
                const modelName = btn.getAttribute('data-model');
                if (confirm(`Delete model "${modelName}"?`)) {
                  btn.disabled = true;
                  btn.textContent = 'Deleting...';
                  try {
                    const result = await window.electronAPI.deleteOllamaModel(modelName);
                    if (result.success) {
                      addLog(`Model ${modelName} deleted`, 'success');
                      updateOllamaUI();
                    } else {
                      addLog(`Failed to delete: ${result.error}`, 'error');
                      btn.disabled = false;
                      btn.textContent = 'Delete';
                    }
                  } catch (err) {
                    addLog(`Error: ${err}`, 'error');
                    btn.disabled = false;
                    btn.textContent = 'Delete';
                  }
                }
              });
            });
          } else {
            modelList.innerHTML = '<div class="empty-models">No models installed. Pull a model to get started.</div>';
          }

        } catch (err) {
          console.error('Failed to get Ollama status:', err);
          ollamaStatusBadge.textContent = 'Error';
          ollamaStatusBadge.style.color = 'var(--error)';
        }
      }

      ollamaToggleBtn.addEventListener('click', async () => {
        ollamaToggleBtn.disabled = true;
        try {
          if (ollamaRunning) {
            addLog('Stopping Ollama...', 'info');
            const result = await window.electronAPI.stopOllama();
            if (!result.success) {
              addLog('Failed to stop Ollama: ' + result.error, 'error');
            }
          } else {
            addLog('Starting Ollama...', 'info');
            const result = await window.electronAPI.startOllama();
            if (!result.success) {
              addLog('Failed to start Ollama: ' + result.error, 'error');
            } else {
              addLog('Ollama started', 'success');
            }
          }
        } catch (err) {
          addLog('Ollama error: ' + err, 'error');
        }
        setTimeout(updateOllamaUI, 1000);
      });

      modelSelect.addEventListener('change', () => {
        modelPullBtn.disabled = !modelSelect.value || !ollamaRunning;
      });

      modelPullBtn.addEventListener('click', async () => {
        const modelName = modelSelect.value;
        if (!modelName) return;

        modelPullBtn.disabled = true;
        modelSelect.disabled = true;
        modelProgress.classList.add('visible');
        modelProgressText.textContent = `Pulling ${modelName}...`;
        modelProgressFill.style.width = '0%';

        try {
          const result = await window.electronAPI.pullOllamaModel(modelName);
          if (result.success) {
            addLog(`Model ${modelName} pulled successfully`, 'success');
            modelProgressText.textContent = 'Complete!';
            modelProgressFill.style.width = '100%';
            setTimeout(() => {
              modelProgress.classList.remove('visible');
              modelSelect.value = '';
              updateOllamaUI();
            }, 1500);
          } else {
            addLog(`Failed to pull model: ${result.error}`, 'error');
            modelProgressText.textContent = 'Failed: ' + result.error;
          }
        } catch (err) {
          addLog(`Pull error: ${err}`, 'error');
          modelProgressText.textContent = 'Error: ' + err;
        }

        modelPullBtn.disabled = false;
        modelSelect.disabled = false;
      });

      // Listen for pull progress
      window.electronAPI.onOllamaPullProgress((data) => {
        modelProgressText.textContent = `${data.model}: ${data.status}`;
        if (data.percent !== undefined) {
          modelProgressFill.style.width = data.percent + '%';
        }
      });

      // Listen for status changes
      window.electronAPI.onOllamaStatusChange((status) => {
        updateOllamaUI();
      });

      // Initial Ollama status check
      updateOllamaUI();

      // Refresh Ollama periodically
      setInterval(() => {
        if (ollamaRunning) {
          updateOllamaUI();
        }
      }, 15000);

      // Resource Limits
      const cpuSlider = document.getElementById('cpu-slider');
      const cpuValue = document.getElementById('cpu-value');
      const ramSlider = document.getElementById('ram-slider');
      const ramValue = document.getElementById('ram-value');
      const storageSlider = document.getElementById('storage-slider');
      const storageValue = document.getElementById('storage-value');
      const gpuSlider = document.getElementById('gpu-slider');
      const gpuValue = document.getElementById('gpu-value');
      const saveLimitsBtn = document.getElementById('save-limits-btn');

      function updateSliderDisplays() {
        const cpuVal = parseInt(cpuSlider.value);
        cpuValue.textContent = cpuVal >= parseInt(cpuSlider.max) ? 'All' : cpuVal;
        ramValue.textContent = ramSlider.value;
        const storageVal = parseInt(storageSlider.value);
        storageValue.textContent = storageVal >= parseInt(storageSlider.max) ? 'All' : storageVal;
        gpuValue.textContent = gpuSlider.value;
      }

      cpuSlider.addEventListener('input', updateSliderDisplays);
      ramSlider.addEventListener('input', updateSliderDisplays);
      storageSlider.addEventListener('input', updateSliderDisplays);
      gpuSlider.addEventListener('input', updateSliderDisplays);

      // Load saved limits
      window.electronAPI.getResourceLimits().then(limits => {
        if (limits) {
          if (limits.cpuCores) { cpuSlider.value = limits.cpuCores; }
          if (limits.ramPercent) { ramSlider.value = limits.ramPercent; }
          if (limits.storageGb) { storageSlider.value = limits.storageGb; }
          if (limits.gpuVramPercent?.[0]) { gpuSlider.value = limits.gpuVramPercent[0]; }
          updateSliderDisplays();
        }
      });

      saveLimitsBtn.addEventListener('click', async () => {
        saveLimitsBtn.disabled = true;
        saveLimitsBtn.textContent = 'Saving...';

        const limits = {
          cpuCores: parseInt(cpuSlider.value) >= parseInt(cpuSlider.max) ? undefined : parseInt(cpuSlider.value),
          ramPercent: parseInt(ramSlider.value) >= 100 ? undefined : parseInt(ramSlider.value),
          storageGb: parseInt(storageSlider.value) >= parseInt(storageSlider.max) ? undefined : parseInt(storageSlider.value),
          gpuVramPercent: parseInt(gpuSlider.value) >= 100 ? undefined : [parseInt(gpuSlider.value)]
        };

        try {
          const result = await window.electronAPI.setResourceLimits(limits);
          if (result.success) {
            saveLimitsBtn.textContent = 'Saved!';
            saveLimitsBtn.classList.add('saved');
            addLog('Resource limits saved', 'success');
            setTimeout(() => {
              saveLimitsBtn.textContent = 'Save Limits';
              saveLimitsBtn.classList.remove('saved');
              saveLimitsBtn.disabled = false;
            }, 1500);
          } else {
            addLog('Failed to save: ' + result.error, 'error');
            saveLimitsBtn.textContent = 'Save Limits';
            saveLimitsBtn.disabled = false;
          }
        } catch (err) {
          addLog('Error: ' + err, 'error');
          saveLimitsBtn.textContent = 'Save Limits';
          saveLimitsBtn.disabled = false;
        }
      });

      window.electronAPI.onLimitsChange(limits => {
        if (limits.cpuCores) cpuSlider.value = limits.cpuCores;
        if (limits.ramPercent) ramSlider.value = limits.ramPercent;
        if (limits.storageGb) storageSlider.value = limits.storageGb;
        if (limits.gpuVramPercent?.[0]) gpuSlider.value = limits.gpuVramPercent[0];
        updateSliderDisplays();
      });

      // Window controls
      document.getElementById('min-btn').addEventListener('click', () => window.electronAPI.minimizeWindow());
      document.getElementById('max-btn').addEventListener('click', () => window.electronAPI.maximizeWindow());
      document.getElementById('close-btn').addEventListener('click', () => window.electronAPI.closeWindow());

      // Remote Control
      const remoteToggle = document.getElementById('remote-toggle');
      window.electronAPI.getRemoteControlEnabled().then(enabled => {
        if (enabled) remoteToggle.classList.add('active');
      });

      remoteToggle.addEventListener('click', async () => {
        const newState = !remoteToggle.classList.contains('active');
        try {
          const result = await window.electronAPI.setRemoteControlEnabled(newState);
          if (result.success) {
            remoteToggle.classList.toggle('active', newState);
            addLog('Remote control ' + (newState ? 'enabled' : 'disabled'), 'success');
          }
        } catch (err) {
          addLog('Error: ' + err, 'error');
        }
      });

      // Dashboard button
      document.getElementById('open-dashboard-btn').addEventListener('click', () => {
        window.electronAPI.openDashboard();
        addLog('Opening dashboard...', 'info');
      });

      // ===== SETUP WIZARD =====
      const wizardOverlay = document.getElementById('setup-wizard-overlay');
      const wizardNextBtn = document.getElementById('wizard-next-btn');
      const wizardSkipBtn = document.getElementById('wizard-skip-btn');
      const wizardDriveSelect = document.getElementById('wizard-drive-select');
      const wizardStorageInfo = document.getElementById('wizard-storage-info');

      let currentWizardStep = 1;
      let wizardDrives = [];
      let wizardHasGpu = false;
      let wizardGpuName = 'No GPU detected';
      let wizardIpfsReady = false;
      let wizardOllamaReady = false;

      function showWizard() {
        wizardOverlay.classList.add('visible');
      }

      function hideWizard() {
        wizardOverlay.classList.remove('visible');
      }

      function updateWizardStep(step) {
        currentWizardStep = step;
        const totalSteps = 5;

        // Update dots
        for (let i = 1; i <= totalSteps; i++) {
          const dot = document.getElementById(`wizard-dot-${i}`);
          if (dot) {
            dot.classList.remove('active', 'completed');
            if (i < step) {
              dot.classList.add('completed');
            } else if (i === step) {
              dot.classList.add('active');
            }
          }
        }

        // Update steps
        for (let i = 1; i <= totalSteps; i++) {
          const stepEl = document.getElementById(`wizard-step-${i}`);
          if (stepEl) {
            stepEl.classList.toggle('active', i === step);
          }
        }

        // Update button text and state
        wizardNextBtn.disabled = false;
        wizardSkipBtn.style.display = 'block';

        switch(step) {
          case 1: // Welcome
            wizardNextBtn.textContent = 'Get Started';
            break;
          case 2: // Storage
            wizardNextBtn.textContent = 'Continue';
            wizardNextBtn.disabled = !wizardDriveSelect.value;
            break;
          case 3: // IPFS
            wizardNextBtn.textContent = wizardIpfsReady ? 'Continue' : 'Setup IPFS';
            break;
          case 4: // Ollama
            wizardNextBtn.textContent = wizardOllamaReady ? 'Continue' : 'Setup Ollama';
            break;
          case 5: // Complete
            wizardNextBtn.textContent = 'Done';
            wizardSkipBtn.style.display = 'none';
            break;
        }
      }

      async function loadWizardDrives() {
        try {
          wizardDrives = await window.electronAPI.getDrives();
          wizardDriveSelect.innerHTML = '<option value="">-- Select a drive --</option>';
          wizardDrives.forEach(drive => {
            const opt = document.createElement('option');
            opt.value = drive.mount;
            opt.textContent = `${drive.mount} - ${drive.available_gb.toFixed(1)} GB free (${drive.type})`;
            wizardDriveSelect.appendChild(opt);
          });
        } catch (err) {
          wizardDriveSelect.innerHTML = '<option value="">Error loading drives</option>';
        }
      }

      async function checkWizardGpu() {
        try {
          const hw = await window.electronAPI.getHardware();
          if (hw.gpus && hw.gpus.length > 0) {
            wizardHasGpu = true;
            wizardGpuName = hw.gpus[0].model;
            document.getElementById('wizard-gpu-name').textContent = wizardGpuName;
            document.getElementById('wizard-gpu-name').style.color = '#76b900';
          } else {
            wizardHasGpu = false;
            wizardGpuName = 'No dedicated GPU';
            document.getElementById('wizard-gpu-name').textContent = wizardGpuName;
            document.getElementById('wizard-gpu-name').style.color = 'var(--text-muted)';
          }
        } catch (err) {
          wizardHasGpu = false;
        }
      }

      wizardDriveSelect.addEventListener('change', () => {
        const selectedDrive = wizardDrives.find(d => d.mount === wizardDriveSelect.value);
        if (selectedDrive) {
          wizardStorageInfo.style.display = 'block';
          document.getElementById('wizard-drive-name').textContent = selectedDrive.mount;
          document.getElementById('wizard-drive-free').textContent = selectedDrive.available_gb.toFixed(1) + ' GB';
          document.getElementById('wizard-storage-path').textContent = selectedDrive.mount + '/otherthing-storage';
          wizardNextBtn.disabled = false;
        } else {
          wizardStorageInfo.style.display = 'none';
          wizardNextBtn.disabled = true;
        }
      });

      // Listen for IPFS download progress
      window.electronAPI.onIPFSDownloadProgress((percent) => {
        const fill = document.getElementById('ipfs-download-progress-fill');
        const text = document.getElementById('ipfs-download-progress-text');
        if (fill) fill.style.width = percent + '%';
        if (text) text.textContent = `Downloading... ${percent}%`;
      });

      // Listen for Ollama install progress
      window.electronAPI.onOllamaInstallProgress((percent) => {
        const fill = document.getElementById('ollama-download-progress-fill');
        const text = document.getElementById('ollama-download-progress-text');
        if (fill) fill.style.width = percent + '%';
        if (text) text.textContent = `Installing... ${percent}%`;
      });

      wizardNextBtn.addEventListener('click', async () => {
        switch(currentWizardStep) {
          case 1: // Welcome -> Storage
            await loadWizardDrives();
            await checkWizardGpu();
            updateWizardStep(2);
            break;

          case 2: // Storage -> IPFS
            if (!wizardDriveSelect.value) return;

            wizardNextBtn.disabled = true;
            wizardNextBtn.textContent = 'Saving...';

            try {
              const result = await window.electronAPI.setStoragePath(wizardDriveSelect.value);
              if (result.success) {
                addLog('Storage location configured: ' + wizardDriveSelect.value, 'success');
                driveSelect.value = wizardDriveSelect.value;
                const selectedDrive = wizardDrives.find(d => d.mount === wizardDriveSelect.value);
                updateDriveDisplay(selectedDrive);

                // Check IPFS status
                const ipfsStatus = await window.electronAPI.getIPFSStatus();
                wizardIpfsReady = ipfsStatus.hasBinary;

                if (wizardIpfsReady) {
                  document.getElementById('ipfs-setup-desc').textContent = 'IPFS is already installed. Click Continue to proceed.';
                  document.getElementById('ipfs-setup-status').style.display = 'block';
                  document.getElementById('ipfs-setup-status-text').textContent = 'Installed';
                  document.getElementById('ipfs-setup-status-text').style.color = 'var(--success)';
                }

                updateWizardStep(3);
              } else {
                addLog('Failed to set storage: ' + result.error, 'error');
                wizardNextBtn.disabled = false;
                wizardNextBtn.textContent = 'Continue';
              }
            } catch (err) {
              addLog('Error: ' + err, 'error');
              wizardNextBtn.disabled = false;
              wizardNextBtn.textContent = 'Continue';
            }
            break;

          case 3: // IPFS -> Ollama
            if (wizardIpfsReady) {
              // Already installed, go to Ollama
              const ollamaStatus = await window.electronAPI.getOllamaStatus();
              wizardOllamaReady = ollamaStatus.installed;
              if (wizardOllamaReady) {
                document.getElementById('ollama-setup-desc').textContent = 'Ollama is already installed. Click Continue to finish setup.';
                document.getElementById('ollama-setup-status').style.display = 'block';
                document.getElementById('ollama-setup-status-text').textContent = ollamaStatus.running ? 'Running' : 'Installed';
                document.getElementById('ollama-setup-status-text').style.color = 'var(--success)';
              }
              updateWizardStep(4);
            } else {
              // Download IPFS
              wizardNextBtn.disabled = true;
              wizardNextBtn.textContent = 'Downloading...';
              document.getElementById('ipfs-download-progress').style.display = 'block';

              try {
                const result = await window.electronAPI.downloadIPFSBinary();
                if (result.success) {
                  addLog('IPFS binary downloaded', 'success');
                  document.getElementById('ipfs-download-progress-fill').style.width = '100%';
                  document.getElementById('ipfs-download-progress-text').textContent = 'Download complete!';
                  document.getElementById('ipfs-setup-status').style.display = 'block';
                  document.getElementById('ipfs-setup-status-text').textContent = 'Installed';
                  document.getElementById('ipfs-setup-status-text').style.color = 'var(--success)';
                  wizardIpfsReady = true;

                  // Check Ollama for next step
                  const ollamaStatus = await window.electronAPI.getOllamaStatus();
                  wizardOllamaReady = ollamaStatus.installed;
                  if (wizardOllamaReady) {
                    document.getElementById('ollama-setup-desc').textContent = 'Ollama is already installed. Click Continue to finish setup.';
                    document.getElementById('ollama-setup-status').style.display = 'block';
                    document.getElementById('ollama-setup-status-text').textContent = ollamaStatus.running ? 'Running' : 'Installed';
                    document.getElementById('ollama-setup-status-text').style.color = 'var(--success)';
                  }

                  setTimeout(() => updateWizardStep(4), 500);
                } else {
                  addLog('IPFS download failed: ' + result.error, 'error');
                  document.getElementById('ipfs-download-progress-text').textContent = 'Failed: ' + result.error;
                  wizardNextBtn.disabled = false;
                  wizardNextBtn.textContent = 'Retry';
                }
              } catch (err) {
                addLog('IPFS download error: ' + err, 'error');
                wizardNextBtn.disabled = false;
                wizardNextBtn.textContent = 'Retry';
              }
            }
            break;

          case 4: // Ollama -> Complete
            if (wizardOllamaReady) {
              // Already installed, go to complete
              await finishWizard();
              updateWizardStep(5);
            } else {
              // Install Ollama - run installer visibly
              wizardNextBtn.disabled = true;
              wizardNextBtn.textContent = 'Downloading...';
              document.getElementById('ollama-download-progress').style.display = 'block';
              document.getElementById('ollama-browse-section').style.display = 'none';

              try {
                const result = await window.electronAPI.installOllama();
                document.getElementById('ollama-download-progress').style.display = 'none';

                // Check if Ollama was detected after install
                const status = await window.electronAPI.getOllamaStatus();
                wizardOllamaReady = status.installed;

                if (wizardOllamaReady) {
                  addLog('Ollama installed and detected', 'success');
                  document.getElementById('ollama-setup-status').style.display = 'block';
                  document.getElementById('ollama-setup-status-text').textContent = 'Installed';
                  document.getElementById('ollama-setup-status-text').style.color = 'var(--success)';
                  const ollamaPath = await window.electronAPI.getOllamaPath();
                  if (ollamaPath) {
                    document.getElementById('ollama-path-row').style.display = 'flex';
                    document.getElementById('ollama-path-display').textContent = ollamaPath;
                  }
                  await finishWizard();
                  setTimeout(() => updateWizardStep(5), 500);
                } else {
                  // Not auto-detected - show browse option
                  addLog('Ollama installer completed - please locate ollama.exe', 'info');
                  document.getElementById('ollama-browse-section').style.display = 'block';
                  document.getElementById('ollama-setup-desc').textContent = 'Installation completed. Please browse to select ollama.exe, or click Continue to skip.';
                  wizardNextBtn.disabled = false;
                  wizardNextBtn.textContent = 'Continue (Skip Ollama)';
                }
              } catch (err) {
                addLog('Ollama install error: ' + err, 'error');
                document.getElementById('ollama-download-progress').style.display = 'none';
                document.getElementById('ollama-browse-section').style.display = 'block';
                document.getElementById('ollama-setup-desc').textContent = 'Installation had an issue. You can browse to select ollama.exe manually, or skip for now.';
                wizardNextBtn.disabled = false;
                wizardNextBtn.textContent = 'Continue (Skip Ollama)';
              }
            }
            break;

          case 5: // Complete - close wizard
            hideWizard();
            updateIPFSStatus();
            updateOllamaStatus();
            break;
        }
      });

      async function finishWizard() {
        // Update final summary
        document.getElementById('wizard-final-path').textContent = wizardDriveSelect.value + '/otherthing-storage';
        document.getElementById('wizard-final-ipfs').textContent = wizardIpfsReady ? 'Ready' : 'Not installed';
        document.getElementById('wizard-final-ipfs').style.color = wizardIpfsReady ? 'var(--success)' : 'var(--text-muted)';
        document.getElementById('wizard-final-ollama').textContent = wizardOllamaReady ? 'Ready' : 'Not installed';
        document.getElementById('wizard-final-ollama').style.color = wizardOllamaReady ? 'var(--success)' : 'var(--text-muted)';

        // Try to start IPFS
        if (wizardIpfsReady) {
          try {
            await window.electronAPI.startIPFS();
            addLog('IPFS started', 'success');
          } catch (e) { }
        }

        // Try to start Ollama
        if (wizardOllamaReady) {
          try {
            await window.electronAPI.startOllama();
            addLog('Ollama started', 'success');
          } catch (e) { }
        }
      }

      wizardSkipBtn.addEventListener('click', () => {
        hideWizard();
        addLog('Setup wizard skipped - configure manually in Settings', 'info');
      });

      // Ollama browse button handler
      document.getElementById('ollama-browse-btn').addEventListener('click', async () => {
        try {
          const filePath = await window.electronAPI.browseForFile({
            title: 'Select ollama.exe',
            filters: [{ name: 'Ollama Executable', extensions: ['exe'] }]
          });

          if (filePath) {
            document.getElementById('ollama-path-input').value = filePath;
            const result = await window.electronAPI.setOllamaPath(filePath);

            if (result.success) {
              wizardOllamaReady = true;
              addLog('Ollama path set: ' + filePath, 'success');
              document.getElementById('ollama-setup-status').style.display = 'block';
              document.getElementById('ollama-setup-status-text').textContent = 'Configured';
              document.getElementById('ollama-setup-status-text').style.color = 'var(--success)';
              document.getElementById('ollama-path-row').style.display = 'flex';
              document.getElementById('ollama-path-display').textContent = filePath;
              document.getElementById('ollama-browse-section').style.display = 'none';
              wizardNextBtn.textContent = 'Continue';

              // Auto-proceed after successful selection
              await finishWizard();
              setTimeout(() => updateWizardStep(5), 500);
            } else {
              addLog('Invalid Ollama path: ' + result.error, 'error');
            }
          }
        } catch (err) {
          addLog('Browse error: ' + err, 'error');
        }
      });

      // Ollama status update function
      async function updateOllamaStatus() {
        try {
          const status = await window.electronAPI.getOllamaStatus();
          // Update UI if we have an Ollama section
          const ollamaStatusEl = document.getElementById('ollama-status-text');
          if (ollamaStatusEl) {
            ollamaStatusEl.textContent = status.running ? 'Running' : (status.installed ? 'Stopped' : 'Not installed');
          }
        } catch (e) { }
      }

      // Check if we need to show the setup wizard
      async function checkSetupNeeded() {
        try {
          const ipfsStatus = await window.electronAPI.getIPFSStatus();
          const ollamaStatus = await window.electronAPI.getOllamaStatus();
          const storagePath = await window.electronAPI.getStoragePath();

          // Show wizard if: no storage path, or IPFS not installed, or Ollama not installed
          const needsSetup = !storagePath || !ipfsStatus.hasBinary || !ollamaStatus.installed;

          if (needsSetup) {
            addLog('First-time setup required', 'info');
            showWizard();
          }
        } catch (err) {
          console.error('Error checking setup:', err);
          // Show wizard on error to be safe
          showWizard();
        }
      }

      // Run setup check after a short delay
      setTimeout(checkSetupNeeded, 500);
    }
  </script>
</body>
</html>
